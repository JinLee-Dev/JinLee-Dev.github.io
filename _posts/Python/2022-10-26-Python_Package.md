---
layout: single
title:  "파이썬 모듈과 패키지"
category: Python
tags: [Python]
date: 2022-10-26
comments : true
---

오늘은 파이썬으로 프로젝트를 구성할 때 필요한 모듈과 패키지에 대해 정리하는 포스팅을 해 보려 합니다.

평소에는 업무에서 자동화가 필요할 때 툴을 만드는 수준으로 파이썬을 사용하고 있어 스크립트 처럼 써와서, 프로젝트 구성에 대한 개념이 딱히 필요하지 않았습니다. 하지만 이번에 구현했던 내용은 단순 스크립트 보단 더 큰 개념의 프로젝트를 구성해야 했습니다.

프로젝트를 구성할 때 필요한 이론, 그리고 구현하면서 어떤 문제가 있었는지, 문제는 어떻게 해결했는지 적어 보겠습니다.

## 파이썬에서의 함수, 모듈, 패키지
### 함수
우리가 아는 그 함수입니다.
```python
def f(x):
    return x
```

## 모듈
모듈은 함수를 하나의 파일에 묶어놓은 단위를 의미합니다.
해당 모듈의 정의를 다른 모듈이나 메인에서 사용할 수 있게 import가 가능합니다.
아래와 같이 구성되며 예시 모듈은 1개의 함수와 1개의 변수를 가지고 있습니다.

`module.py`
```python
a = 0
def f(x):
    return x
```
<br>

Module Import는 아래와 같은 방식으로 수행합니다.
```python
# 해당 모듈 전체를 가지고 온다
import module

# 모듈을 불러왔기 때문에 f(x)를 수행하려면 아래와 같이 해야 한다
ret = module.f(x)
```
아래는 `from` 절을 이용한 module import입니다.
```python
# module에서 f 함수를 가지고 온다
from module import f

# 함수를 불러왔기 때문에 모듈을 안붙여도 된다
ret = f(x)
```

## 패키지
패키지는 모듈을 모아놓은 디렉토리입니다.
바로 아래 Case의 PackageA가 패키지가 될 수 있습니다.
```
📂PackageA
┣ 📜__init__.py
┣ 📜moduleA.py
┗ 📜moduleB.py
```

여기서 `__init__.py`는 패키지로 인식을 할 수 있게 만드는 파일입니다. 따로 내용을 안 넣어도 되는데, 해당 파일은 Package Import시 제일 처음으로 실행되는 파일이기 때문에 해당 패키지에 필요한 정보를 위 파일에 넣어놓기도 합니다. 

Python 3.3 이후에는 없어도 되지만, 호환성을 위해 넣어두는 것이 좋다고 합니다.

그리고, Package Import도 Module과 동일한 방식으로 수행됩니다.


## 트러블 슈팅
### C++에서와 다르게 모듈의 폴더 기준 상대 경로가 안 된다.
C++을 사용하여 특정 기능을 구현할 경우, 구현하는 파일 기준의 상대경로 or 특정 폴더를 기준으로 한 절대 경로, 둘 다 사용할 수 있습니다. 하지만 파이썬은 **실행한 파일을 기준으로 한 절대 경로 및 상대경로** 만 사용이 가능합니다.

결국 Package로 나눴다 하더라도 Package에서 import를 할려면 실행하는 파일(아마 메인이 있는 지점)을 기준으로 import를 시켜야 합니다. 다른 코드를 봐도 시작점 기준으로 import를 수행하고 있습니다.

제가 원했던 폴더 구조는 아래와 같습니다. 
```
📦Project
 ┣ 📂PackageA
 ┃ ┣ 📜__init__.py
 ┃ ┣ 📜moduleA.py
 ┃ ┗ 📜moduleB.py
 ┣ 📂PackageB
 ┃ ┣ 📜__init__.py
 ┃ ┣ 📜moduleC.py
 ┃ ┗ 📜moduleD.py
 ┗ 📜main.py
 ```

하지만 제가 구성했던 Package 중 하나는 AutoGenerated된 코드라 수정을 왠만하면 하지 않아야 했기 때문에, **코드를 바꾸지 않으면서** 해당 폴더 구조를 유지할 방법이 필요했습니다.

여러 가지 방법이 있으나, 저는 각 패키지 별 `__init__.py`에 해당 패키지의 절대 경로를 모듈로 불러울 수 있게 처리하여 수정하였습니다.